@using ServerManagement.Models
@rendermode InteractiveServer

<div class="container-fluid text-center">
    <div class="row w-50">
        @foreach (var city in cities)
        {
            <CityComponent City="@city" IsSelected="@(IsSelected(city))"
                           SelectCityCallBack="HandleCitySelection"></CityComponent>
            @* <CityComponent City="@city" IsSelected="@(selectedCity.Equals(city,StringComparison.OrdinalIgnoreCase)" ></CityComponent> *@

        }
    </div>
</div>

@code {
    [Parameter]
    public EventCallback<string> SelectCityCallBack { get; set; }

    private List<string> cities = CitiesRepository.GetCities();
    private string selectedCity = "Toronto";
    private bool IsSelected(string city) => selectedCity.Equals(city,StringComparison.OrdinalIgnoreCase);

    public void ClearSelection()
    {
        this.selectedCity = string.Empty;   
    }

    private void HandleCitySelection(string city)
    {
        this.selectedCity = city;
        SelectCityCallBack.InvokeAsync(city);
    }
}
